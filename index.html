<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Binary Tree Visuals</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.2/full/pyodide.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    #slider {
      width: 300px;
    }
    .plots-container {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
    }
    .plot-section {
      text-align: center;
    }
    img {
      margin-top: 10px;
      border: 1px solid #ccc;
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <header>
    <h1>Binary Tree Visuals</h1>
  </header>
  <main>
    <label for="slider"># Leaves:</label>
    <input type="range" id="slider" min="1" max="20" value="4">
    <span id="slider-value">4</span>

    <div class="plots-container">
      <div class="plot-section">
        <h3 id="title-balanced"></h3>
        <img id="img-balanced" alt="Balanced Binary Tree Visualization">
      </div>
      <div class="plot-section">
        <h3 id="title-unbalanced"></h3>
        <img id="img-unbalanced" alt="Unbalanced Binary Tree Visualization">
      </div>
    </div>
  </main>
  <script>
    async function main() {
      try {
        window.pyodide = await loadPyodide();
        await pyodide.runPythonAsync(`
import micropip
await micropip.install("networkx")
await micropip.install("matplotlib")
        `);

        const pythonCode = `
# (Insert Python code here from your script)
        `;
        await pyodide.runPythonAsync(pythonCode);

        window.drawTrees = async function (numLeaves) {
          const pyRes = await pyodide.runPythonAsync(`
bal64, unbal64 = draw_trees(${numLeaves})
(bal64, unbal64)
          `);
          return pyRes.toJs();
        };
      } catch (error) {
        console.error("Error loading Pyodide or executing code:", error);
        alert("An error occurred while loading the application.");
      }
    }

    main().then(() => {
      const slider = document.getElementById("slider");
      const sliderVal = document.getElementById("slider-value");
      const titleBalanced = document.getElementById("title-balanced");
      const titleUnbalanced = document.getElementById("title-unbalanced");
      const imgBalanced = document.getElementById("img-balanced");
      const imgUnbalanced = document.getElementById("img-unbalanced");

      async function updateTrees() {
        const numLeaves = slider.value;
        sliderVal.textContent = numLeaves;
        const [b64Balanced, b64Unbalanced] = await window.drawTrees(numLeaves);
        imgBalanced.src = "data:image/png;base64," + b64Balanced;
        imgUnbalanced.src = "data:image/png;base64," + b64Unbalanced;

        titleBalanced.textContent = "Balanced (Leaves=" + numLeaves + ")";
        titleUnbalanced.textContent = "Random Unbalanced (Leaves=" + numLeaves + ")";
      }

      slider.addEventListener("input", updateTrees);
      updateTrees();
    });
  </script>
</body>
</html>
